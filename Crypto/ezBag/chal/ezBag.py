from Crypto.Cipher import AES
from Crypto.Util.number import *
from Crypto.Util.Padding import pad
from secrets import flag
import random
import hashlib

list = []
sum = []
p=random.getrandbits(64)    
assert len(bin(p)[2:])==64 

for i in range(6):                              
    t = p
    a=[getPrime(16) for _ in range(64)]        
    s=0                                        
    for x in a:
        temp=t%2                               
        s+=temp*x                              
        t=t>>1                                
    list.append(a)                             
    sum.append(s)                              


key = hashlib.sha256(str(p).encode()).digest()  
cipher = AES.new(key, AES.MODE_ECB)   
plaintext = pad(flag,16)                            
ciphertext = cipher.encrypt(plaintext)      
print(f'list={list}')
print(f'sum={sum}')        
print(f"ciphertext={ciphertext}")

"""
list=[[60611, 63793, 44839, 55619, 49529, 61879, 58603, 55469, 46919, 57719, 34157, 36299, 46021, 46573, 48539, 51137, 46309, 44617, 36599, 44491, 60763, 49943, 58567, 36527, 34381, 42073, 38197, 38329, 43201, 33053, 41077, 39667, 49547, 45659, 42131, 62969, 53719, 61343, 41593, 43481, 39821, 35257, 63857, 53813, 47777, 34589, 58237, 59443, 58243, 56993, 49393, 64553, 43411, 64679, 50909, 59107, 63773, 55073, 50543, 34537, 63281, 55817, 44729, 55889], [36229, 45817, 33773, 36451, 43573, 64747, 36457, 49069, 57751, 60443, 63719, 61031, 41759, 57637, 55469, 43487, 52859, 54413, 36847, 36563, 33413, 39937, 58057, 53279, 51263, 62201, 52667, 34483, 40009, 48757, 62099, 34963, 49171, 34429, 54767, 40531, 50411, 33857, 35851, 60103, 49993, 59471, 41603, 58231, 39241, 36697, 63599, 65203, 42487, 41381, 55871, 47303, 39043, 37529, 56783, 54751, 64157, 37483, 40237, 41051, 38791, 36791, 54709, 34361], [34631, 64217, 40009, 59023, 33721, 33587, 58543, 41453, 33937, 50549, 53267, 46103, 51803, 36343, 44189, 41771, 38189, 36389, 62131, 59567, 42859, 37699, 47147, 55897, 37547, 43051, 46229, 58979, 44753, 38351, 46867, 61483, 34147, 36761, 50123, 60679, 43067, 56039, 49741, 62207, 48619, 34283, 48131, 43753, 42719, 63853, 41911, 40123, 60647, 60679, 33377, 56591, 32939, 44201, 57637, 38119, 43613, 44021, 63241, 53161, 41999, 50207, 56929, 48907], [55817, 43951, 40231, 32801, 57329, 41849, 57719, 56599, 50753, 52081, 42689, 35279, 34673, 64091, 50033, 38039, 37339, 50789, 48857, 57089, 47287, 34127, 54881, 38767, 38747, 63823, 57653, 56911, 39199, 56543, 48857, 42337, 50723, 62873, 63149, 39761, 37357, 61253, 44971, 48121, 41981, 33587, 64621, 42641, 52889, 34319, 38201, 41761, 33317, 58453, 41957, 52057, 63473, 57139, 53959, 38933, 39133, 38567, 47093, 35171, 50773, 48487, 43607, 34513], [53591, 59441, 56359, 59621, 45161, 43793, 49451, 64483, 49223, 47837, 49559, 52501, 59063, 35851, 38393, 48673, 60209, 41737, 51479, 41051, 60637, 61487, 41141, 42331, 49307, 59651, 54409, 57713, 51899, 34841, 34589, 61909, 56149, 50767, 55661, 58897, 50543, 55171, 64067, 42131, 47353, 36457, 44221, 56813, 44893, 48847, 51839, 53927, 45599, 41231, 53629, 44159, 61153, 33893, 48353, 38083, 33469, 62659, 38833, 48989, 49333, 63913, 65239, 41051], [34519, 40787, 48481, 48463, 34303, 53453, 48907, 62383, 49757, 58441, 33619, 42689, 58049, 53129, 46237, 34649, 40343, 40123, 57899, 45181, 36887, 34211, 50587, 58207, 40499, 55733, 49333, 59951, 32957, 42701, 56663, 45403, 47251, 33739, 47977, 36107, 37013, 37529, 62119, 38237, 35537, 54367, 37847, 36767, 33623, 65213, 42961, 39419, 50513, 62191, 32783, 43201, 34259, 54647, 58313, 54799, 52489, 64591, 37493, 45833, 53927, 56533, 54293, 35507]]
sum=[1312530, 1199130, 1235468, 1289298, 1307088, 1246882]
ciphertext=b'l\xb7\\\xdd\xd6\xe5\xd9Q\xa2fWUg\x90\x08k\xe7\x9d\x06\x84\x89"B\xeb\xee5|\xce?JF\xac\x1a$G\xd2S\x14\xea\x7f\xaf\xfa"\x9a"\xbbr\xf6'
"""